<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Body Details ‚Äì Palette and Fit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Same font setup as SIGNUP1 -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
:root {
  --bg-light: #f6f3fc;
  --accent: #ad00e2;
  --card-bg: #ffffff;
  --text: #20144a;
  --input-border: #d4c4ef;
  --input-bg: #ffffff;
  --shadow: 0 8px 36px #ad00e222, 0 1.5px 8px #ad00e208;
  --shadow-dark: 0 6px 32px #0003, 0 1.5px 8px #0002;
  --btn-purple: #ad00e2;
  --btn-purple-dark: #7a2df6;
  --top-pill-width: 150px;

  --custom-bg: url('data:image/jpeg;base64,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');
}

/* global layout */
*,
*::before,
*::after { box-sizing: border-box; }

html, body { height: 100%; font-family: "Poppins", sans-serif; }

body {
  margin: 0;
  color: var(--text);
  min-height: 100vh;
  padding: clamp(1.5rem, 4vh, 3rem) clamp(0.8rem, 4vw, 1.8rem) 0;
  background: none;
  position: relative;
  overflow-x: hidden;
  transition: background 0.3s, color 0.3s;
}

/* use Poppins inside form controls too */
input, button, select, textarea {
  font-family: "Poppins", sans-serif;
}

/* background layer */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: var(--custom-bg) center center/cover no-repeat fixed;
  z-index: -1;
  filter: brightness(1) contrast(1.02) saturate(1.1);
  transition: filter 0.3s;
}

/* dark mode vars */
body.dark-mode {
  color: #fff;
  --input-bg: #201830;
  --card-bg: #2a203d;
  --text: #e7d6fa;
  --input-border: #8852c9;
  --btn-purple: #ad00e2;
  --btn-purple-dark: #7a2df6;
}
body.dark-mode::before {
  filter: brightness(0.66) contrast(1.08) saturate(1.15);
}

/* card */
.container {
  width: 100%;
  max-width: 640px;
  margin: 0 auto;
  background: var(--card-bg);
  border-radius: 2.2rem;
  box-shadow: var(--shadow);
  padding: 1.3rem 2.4rem 1.7rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  backdrop-filter: blur(12px);
  transition: background 0.3s, box-shadow 0.3s;
}
body.dark-mode .container {
  background: #231e2f;
  box-shadow: var(--shadow-dark);
}

/* top bar */
.top-bar {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.6rem;
  margin-bottom: 0.7rem;
}
.pill-btn {
  min-width: var(--top-pill-width);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 0.46rem 1.15rem;
  border-radius: 999px;
  border: none;
  font-size: 0.9rem;
  font-weight: 700;
  white-space: nowrap;
  box-shadow: 0 2px 12px #ad00e225;
  cursor: pointer;
  text-decoration: none;
  text-align: center;
  transition: background 0.18s, color 0.18s,
              box-shadow 0.18s, transform 0.12s;
}
body:not(.dark-mode) .pill-btn { background: var(--accent); color: #ffffff; }
body.dark-mode .pill-btn       { background: #ffffff; color: var(--accent); }
.pill-btn:hover,
.pill-btn:focus-visible {
  transform: translateY(-1px);
  box-shadow: 0 4px 16px rgba(173, 0, 226, 0.32);
}
body:not(.dark-mode) .pill-btn:hover,
body:not(.dark-mode) .pill-btn:focus-visible {
  background: var(--btn-purple-dark); color: #ffffff;
}
body.dark-mode .pill-btn:hover,
body.dark-mode .pill-btn:focus-visible {
  background: #f7f1ff; color: #7a2df6;
}
.back-btn::before { content: "‚Üê"; font-size: 0.93rem; }

/* steps */
.progress-bar {
  display: flex;
  justify-content: center;
  align-items: flex-end;
  gap: 2.2rem;
  margin: 0.2rem 0 0.4rem;
  width: 100%;
}
.step {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 1.04rem;
  font-weight: 600;
  color: #b3a5c7;
  gap: 0.2rem;
  transition: color 0.18s;
}
.step.active { color: var(--accent); font-weight: 900; }
.step-circle {
  width: 36px; height: 36px;
  border-radius: 50%;
  background: #f5eaff;
  color: var(--accent);
  display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: 1.2rem;
  border: 2.5px solid #e8d8fd;
  box-shadow: 0 2px 10px #ad00e21c;
}
.step.active .step-circle {
  background: var(--accent); color: #fff; border-color: var(--accent);
  box-shadow: 0 4px 16px #ad00e246;
}
body.dark-mode .step-circle {
  background: #3b1853; color: var(--accent); border-color: var(--accent);
}
body.dark-mode .step.active .step-circle {
  background: var(--accent); color: #fff; border-color: #fff;
}

/* tagline + heading */
.tagline {
  margin-top: 0.2rem;
  font-size: 0.92rem;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: #7b57c4;
  text-align: center;
}
body.dark-mode .tagline { color: #d3c0ff; }

.heading-row {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 0.4rem;
}
.heading-row h2 {
  margin: 0.3rem 0 0;
  color: var(--accent);
  text-align: center;
  font-weight: 800;
  font-size: 2.05rem;
  letter-spacing: 0.3px;
  text-shadow: 0 1px 8px #e8d8fd;
}
body.dark-mode .heading-row h2 {
  color: #fff;
  text-shadow: 0 1px 12px #7a2df6;
}

/* label + info icon row */
.field-row {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  justify-content: flex-start;
  width: auto;
}
.field-row label {
  flex: 0 0 auto;
  margin-right: 0;
}

.info-dot {
  position: relative;
  width: 22px; height: 22px;
  border-radius: 50%;
  border: none;
  cursor: pointer;
  background: #ffffff;
  color: var(--accent);
  font-weight: 800;
  font-size: 0.9rem;
  box-shadow: 0 0 10px rgba(173, 0, 226, 0.4);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}
body.dark-mode .info-dot { background: #fefbff; }

/* tooltip */
.info-dot .tooltip {
  position: absolute;
  top: 130%;
  left: 50%;
  transform: translate(-50%, 0);
  width: min(260px, 90vw);
  background: #ffffff;
  color: #5a458f;
  padding: 0.6rem 0.8rem;
  border-radius: 0.8rem;
  box-shadow: 0 8px 26px rgba(0, 0, 0, 0.18);
  font-size: 0.8rem;
  line-height: 1.5;
  text-align: left;
  white-space: normal;
  z-index: 10;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.18s ease, transform 0.18s ease;
}
.info-dot:hover .tooltip,
.info-dot:focus-within .tooltip {
  opacity: 1;
  transform: translate(-50%, 6px);
}
body.dark-mode .info-dot .tooltip {
  background: #362456;
  color: #f1e9ff;
}

/* form + inputs */
form {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 0.7rem;
  margin-top: 0.4rem;
}
label {
  font-size: 1.01rem;
  font-weight: 600;
  color: #7054ad;
  margin-left: 2px;
}
body.dark-mode label { color: #cbbcf3; }

input {
  width: 100%;
  padding: 0.48rem 1.1rem;
  border-radius: 1rem;
  border: 1.5px solid var(--input-border);
  background: var(--input-bg);
  font-size: 1.06rem;
  color: var(--text);
  outline: none;
  height: 2.02rem;
  box-shadow: 0 0.5px 3px #b292d11c;
  transition: border-color 0.18s, box-shadow 0.19s, background 0.18s;
}
input:focus {
  border-color: var(--accent);
  background: #f7f0fd;
  box-shadow: 0 2px 12px #c6a1e817;
}
body.dark-mode input {
  background: #271a36;
  border-color: #845acb;
  color: #ffffff;
}

/* continue button */
.btn {
  margin-top: 0.17rem;
  background: var(--btn-purple);
  color: #fff;
  font-weight: 700;
  font-size: 1.11rem;
  border: none;
  padding: 0.71rem 0;
  border-radius: 1rem;
  cursor: pointer;
  width: 100%;
  box-shadow: 0 2.2px 14px #ad00e222;
  transition: background 0.19s, transform 0.13s;
}
.btn:hover {
  background: var(--btn-purple-dark);
  transform: translateY(-1px) scale(1.01);
}

/* responsive */
@media (max-width: 700px) {
  :root { --top-pill-width: 130px; }
  body { padding: 1.8rem 0.75rem 0; }
  .container { padding: 1rem 1rem 1.3rem; border-radius: 1.7rem; }
  .progress-bar { gap: 1.4rem; }
  .heading-row h2 { font-size: 1.6rem; }
  .step-circle { width: 28px; height: 28px; font-size: 1rem; }
  .step, label { font-size: 0.93rem; }
  input { font-size: 0.95rem; height: 1.8rem; }
  .btn { font-size: 1rem; padding: 0.65rem 0; }
}

@media (max-width: 400px) {
  :root { --top-pill-width: 115px; }
  body { padding: 1.4rem 0.5rem 0; }
  .container { padding: 0.85rem 0.85rem 1.1rem; border-radius: 1.45rem; }
  .heading-row h2 { font-size: 1.35rem; }
  .step, label { font-size: 0.86rem; }
  .step-circle { width: 22px; height: 22px; font-size: 0.85rem; }
  .btn { font-size: 0.93rem; padding: 0.6rem 0; }
}
  </style>
</head>
<body>
  <div class="container">
    <!-- top bar -->
    <div class="top-bar">
      <button type="button" class="pill-btn back-btn" onclick="goBack()">Back</button>
      <button class="pill-btn dark-toggle" id="toggleDark">üåô Dark Mode</button>
    </div>

    <div class="progress-bar">
      <div class="step"><div class="step-circle">1</div>Account</div>
      <div class="step"><div class="step-circle">2</div>Profile</div>
      <div class="step active"><div class="step-circle">3</div>Body</div>
    </div>

    <p class="tagline">LET‚ÄôS SIGN UP TO PALETTE AND FIT</p>

    <div class="heading-row">
      <h2>Enter Your Body Details</h2>
    </div>

    <form id="bodyForm" autocomplete="off">
      <!-- weight -->
      <div class="field-row">
        <label for="weight">Weight (kg)</label>
        <button type="button" class="info-dot" aria-label="Weight measuring help">
          i
          <div class="tooltip">
            Weight (kg): use your usual scale value, for example 68&nbsp;kg.
          </div>
        </button>
      </div>
      <input type="number" id="weight" min="20" max="200" placeholder="Enter your weight" required>

      <!-- body length -->
      <div class="field-row">
        <label for="bodyLength">Body Length (inches)</label>
        <button type="button" class="info-dot" aria-label="Body length measuring help">
          i
          <div class="tooltip">
            Body length (inches): total height from head to heel. Example: 5‚Ä≤4‚Ä≥ = 64&nbsp;inches, so type 64.
          </div>
        </button>
      </div>
      <input type="number" id="bodyLength" min="40" max="90" placeholder="Length" required>

      <!-- upper width -->
      <div class="field-row">
        <label for="upperWidth">Upper Body Width (inches)</label>
        <button type="button" class="info-dot" aria-label="Upper body width measuring help">
          i
          <div class="tooltip">
            Upper body width: measure across the widest part of your shoulders or chest, in inches.
          </div>
        </button>
      </div>
      <input type="number" id="upperWidth" min="10" max="40" placeholder="Width" required>

      <!-- lower width -->
      <div class="field-row">
        <label for="lowerWidth">Lower Body Width (inches)</label>
        <button type="button" class="info-dot" aria-label="Lower body width measuring help">
          i
          <div class="tooltip">
            Lower body width: measure across the fullest part of your hips, in inches.
          </div>
        </button>
      </div>
      <input type="number" id="lowerWidth" min="10" max="40" placeholder="Width" required>

      <button class="btn" type="submit">Continue</button>
    </form>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const API_BASE = 'https://palette-and-fit-backend.onrender.com';

  /* ---------- Back button ---------- */
  window.goBack = function () {
    window.location = 'SIGNUP2.html';
  };

  /* ---------- Dark mode ---------- */
  const darkBtn = document.getElementById('toggleDark');
  const bodyEl  = document.body;

  function updateDarkText() {
    const isDark = bodyEl.classList.contains('dark-mode');
    if (darkBtn) {
      darkBtn.textContent = isDark ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
    }
  }

  function toggleDark() {
    const nowDark = bodyEl.classList.toggle('dark-mode');
    localStorage.setItem('darkMode', nowDark ? 'true' : 'false');
    updateDarkText();
  }

  if (localStorage.getItem('darkMode') === 'true') {
    bodyEl.classList.add('dark-mode');
  }
  updateDarkText();
  darkBtn && darkBtn.addEventListener('click', toggleDark);

  /* ---------- Height badge (62 -> 5'2") ---------- */
  (function () {
    const input = document.getElementById('bodyLength');
    if (!input) return;

    const style = document.createElement('style');
    style.textContent = `
      .height-tag{
        margin-left:8px;padding:2px 10px;border-radius:999px;
        background:#f5eaff;color:#7a2df6;font-weight:700;font-size:.95rem;
        display:inline-block;vertical-align:middle
      }
      body.dark-mode .height-tag{background:#3b1853;color:#fff}
    `;
    document.head.appendChild(style);

    const badge = document.createElement('span');
    badge.id = 'heightFi';
    badge.className = 'height-tag';
    input.insertAdjacentElement('afterend', badge);

    function updateBadgeFromInches(val) {
      const inches = parseFloat(val);
      if (!isFinite(inches) || inches <= 0) {
        badge.textContent = '';
        return;
      }
      const ft  = Math.floor(inches / 12);
      const ins = Math.round(inches - ft * 12);
      badge.textContent = `${ft}'${ins}`;
    }

    input.addEventListener('input', () => updateBadgeFromInches(input.value));
    updateBadgeFromInches(input.value || '');
  })();

  /* ---------- Relax min/max on widths ---------- */
  (function () {
    const up  = document.getElementById('upperWidth');
    const low = document.getElementById('lowerWidth');
    [up, low].forEach(el => {
      if (!el) return;
      el.removeAttribute('min');
      el.removeAttribute('max');
    });
  })();

  /* ---------- Submit to Render backend ---------- */
  const bodyForm = document.getElementById('bodyForm');

  bodyForm?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const weight     = parseFloat(document.getElementById('weight').value);
    const bodyLength = parseFloat(document.getElementById('bodyLength').value);
    const upperWidth = parseFloat(document.getElementById('upperWidth').value);
    const lowerWidth = parseFloat(document.getElementById('lowerWidth').value);

    const email =
      localStorage.getItem('signupEmail') ||
      localStorage.getItem('user_email');

    if (email) {
      localStorage.setItem('user_email', email);
    }

    if (!email) {
      alert('Signup session expired! Please signup again.');
      window.location = 'SIGNUP1.html';
      return;
    }

    try {
      const res = await fetch(`${API_BASE}/api/body`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          email,
          weight,
          body_length: bodyLength,
          upper_width: upperWidth,
          lower_width: lowerWidth
        })
      });

      const data = await res.json().catch(() => ({}));

      if (res.ok) {
        // you can also store locally if you like
        localStorage.setItem('bodyData', JSON.stringify({
          email,
          weight,
          body_length: bodyLength,
          upper_width: upperWidth,
          lower_width: lowerWidth
        }));
        window.location = 'welcome.html';
      } else {
        alert('Error: ' + (data.error || 'Could not save body details.'));
      }
    } catch (err) {
      console.error(err);
      alert('Network error. Please try again.');
    }
  });
});
</script>
</body>
</html>
